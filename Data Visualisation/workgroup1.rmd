---
title: "WorkGroup1"
author: "Group19: Xiang Li, Jiayi Jiang"
date: "2024/3/6"
output: pdf_document
---
```{r setup, include = FALSE}
knitr::opts_chunk$set(tidy_opts = list(width.cutoff = 55), tidy = TRUE)
```
```{r}
library(eurostat)
library(dtplyr)
library(readr)
library(reshape2)
library(tidyr)
library(ggplot2)
```
```{r}
gdp_df = get_eurostat("nama_10_gdp")
write_csv(gdp_df, file = "data/gdp.csv")
gdp_df_wide = dcast(gdp_df, geo + unit + TIME_PERIOD ~ na_item, value.var = 'values')
gdp_df_wide = dplyr::rename(gdp_df_wide, GDP = 'B1G', FCE= 'P3', AIC = 'P41', GCF = 'P5G', EGS = 'P6', EG="P61",ES="P62",IGS="P7",IG="P71",IS="P72",CE="D1",TPI="D2")
gdp_df_wide = gdp_df_wide[, c('geo', 'unit', 'TIME_PERIOD', 'GDP', 'FCE', 'AIC', 'GCF', 'EGS', 'EG', 'ES', 'IGS', 'IG', 'IS', 'CE', 'TPI')]
write_csv(gdp_df_wide, file = "data/gdp_wide.csv")
# GDP=value added,gross;FCE=Final consumption expenditure;AIC=Actual individual consumption;GCF=Gross capital formation;EGS=Exports of goods and services;EG=Exports of goods;ES=Exports of services;IGS=lmports of goods and services;IG=Imports of goods;IS=Imports of services;CE=Compensation of employees;TPI=Taxes on production and imports
```
```{r}
gdp_df_wide = read.csv('data/gdp_wide.csv')
gdp_df_wide$TIME_PERIOD = as.Date(gdp_df_wide$TIME_PERIOD)
```
## Bar plot of GDP,2023
```{r}
df1 = gdp_df_wide[(gdp_df_wide$TIME_PERIOD == '2023-01-01') & !(gdp_df_wide$geo %in% c('EU27_2020', 'EU28', 'EU15', 'EA', 'EA12', 'EA19', 'EA20')) & (gdp_df_wide$unit == 'CP_MEUR'), ]
ggplot(data = df1, mapping = aes(x = reorder(x = geo, X = GDP, FUN = 'identity'), y = GDP)) +
geom_bar(stat = 'identity', fill = 'blue', alpha = 0.4) +
labs(x = 'country', y = 'GDP, 2023') + coord_flip()
```
## plot of Exports of goods and services
```{r}
# ggplot(data = df1, mapping = aes(x = reorder(x = geo, X = EGS, FUN = 'identity'), y = GDP)) +
# geom_bar(stat = 'identity', fill = 'blue', alpha = 0.4) +
# labs(x = 'country', y = 'GDP, 2023') + coord_flip()
df2 = gdp_df_wide[gdp_df_wide$geo %in% c('NL', 'DE', 'ES', 'FR') & (gdp_df_wide$unit == 'CP_MEUR'), ]
ggplot(data = df2, mapping = aes(x = TIME_PERIOD, y = EGS, group = geo, color = geo)) +
  geom_line() +
  labs(x = 'Date', y = 'Exports of goods and services') +
  guides(color = guide_legend(title = 'country'))
```
## plot of Compensation of employees
```{r}
gdp_df = read.csv('data/gdp_wide.csv')
gdp_df_c4=gdp_df[gdp_df$geo %in% c("FR","NL","SE","UK"),]
gdp_c4=gdp_df_c4[gdp_df_c4$unit=="CP_MNAC",]
gdp_c4$TIME_PERIOD=as.Date(gdp_c4$TIME_PERIOD)
gdp_c4$Country=gdp_c4$geo
theme_set(theme_classic())
ggplot(data=gdp_c4,mapping=aes(x=TIME_PERIOD,y= CE,group=Country,color=Country,linetype=Country))+
  geom_line()+
  scale_x_date(labels = scales::date_format("%Y"))+
  scale_color_manual(values=c("red","blue","black","brown"))+
  labs(x="Time",y="",title="Compensation of employees",
       subtitle = "4 countries:France  Netherlands  Sweden  United Kingdom")
```
